---
title: "BIOINF 531 HW7"
author: "Jeongbin Park"
date: "2025-03-09"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

> Helpful reminder: When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. I recommend keeping it to **Knit to HTML**. You may delete this message.   


## Libraries
```{r}
library("glue")
# Include libraries here
```



## 1
아래는 문제의 해설과 함께 R Markdown 형식의 예시 답안입니다. R Markdown에서 수식 표기는 $$ ... $$ 또는 \\(...\\) 형태를 사용하시면 됩니다.

---

## R Markdown 예시 답안

```r
---
title: "Solution to Problem 1 (Estimation for the Poisson rate)"
author: "Your Name"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Problem 1

**문제 요약**  
- 표본 \\( X_1, X_2, \dots, X_n \\)이 서로 독립이고, 각각 Poisson(\\(\lambda\\)) 분포를 따른다.
- (A) 가능한 \\(\lambda\\)에 대한 likelihood 함수 \\(L(\lambda)\\)를 쓰고, \\(\lambda\\)의 MLE(Maximum Likelihood Estimator)를 구한다.
- (B) MLE의 기댓값과 분산을 구하고, 불편추정량인지 확인한다. 또한 MLE의 분포와, \\(n\\)이 클 때(대표본) 점근분포(asymptotic distribution)를 제시한다.

---

## (A) Likelihood 함수와 MLE

### 1. Likelihood 함수

포아송 분포의 확률질량함수(pm.f.)는 
\\[
P(X_i = x_i) = \frac{\lambda^{x_i} e^{-\lambda}}{x_i!}, 
\\]
(\\( x_i = 0, 1, 2, \ldots \\))  
이므로, 독립 표본 \\( X_1, \dots, X_n \\)에 대한 합동확률(우도, likelihood)은

\\[
L(\lambda \mid x_1,\dots,x_n) 
= \prod_{i=1}^n P(X_i = x_i) 
= \prod_{i=1}^n \frac{\lambda^{x_i} e^{-\lambda}}{x_i!}.
\\]

상수항(\\( x_i! \\) 부분)은 \\(\lambda\\)에 영향을 주지 않으므로 묶어서 정리하면,

\\[
L(\lambda \mid x_1,\dots,x_n)
= \left(\prod_{i=1}^n \frac{1}{x_i!}\right) \, \lambda^{\sum_{i=1}^n x_i} e^{-n\lambda}.
\\]

### 2. Log-likelihood 함수

일반적으로 MLE를 구할 때는 로그우도(log-likelihood)를 사용합니다:

\\[
\ell(\lambda) 
= \log L(\lambda) 
= \sum_{i=1}^n \left[ x_i \log \lambda - \lambda \right]
  + \text{(\\(\lambda\\)에 상수인 항)}.
\\]

상수항을 제외하면,

\\[
\ell(\lambda) = \left(\sum_{i=1}^n x_i\right)\log(\lambda) - n\lambda 
  + \text{constant}.
\\]

### 3. MLE 구하기

\\(\ell(\lambda)\\)을 \\(\lambda\\)에 대해 미분하고 0이 되는 지점을 찾습니다.

\\[
\frac{d\ell(\lambda)}{d\lambda} 
= \frac{\sum_{i=1}^n x_i}{\lambda} - n = 0.
\\]

이로부터,

\\[
\hat{\lambda}_{MLE} 
= \frac{1}{n}\sum_{i=1}^n x_i \;\; = \bar{X}.
\\]

즉, 포아송분포에서 \\(\lambda\\)의 MLE는 표본평균 \\(\bar{X}\\)임을 알 수 있습니다.

---

## (B) MLE의 기댓값, 분산, 불편성, 분포 및 점근분포

### 1. 기댓값과 분산

MLE \\(\hat{\lambda}_{MLE} = \bar{X} = \frac{1}{n}\sum_{i=1}^n X_i\\) 이므로,
- 각 \\(X_i\\)의 \\(\mathrm{E}[X_i] = \lambda\\), \\(\mathrm{Var}(X_i) = \lambda\\).
- 표본평균의 기댓값은 
  \\[
  \mathrm{E}[\bar{X}] 
  = \mathrm{E}\Big[\frac{1}{n}\sum_{i=1}^n X_i\Big] 
  = \frac{1}{n}\sum_{i=1}^n \mathrm{E}[X_i] 
  = \frac{1}{n} \cdot n\lambda 
  = \lambda.
  \\]
- 표본평균의 분산은 
  \\[
  \mathrm{Var}(\bar{X}) 
  = \frac{1}{n^2}\mathrm{Var}\Big(\sum_{i=1}^n X_i\Big) 
  = \frac{1}{n^2} \cdot n\lambda  
  = \frac{\lambda}{n}.
  \\]

따라서 
\\[
\mathrm{E}[\hat{\lambda}_{MLE}] = \lambda, 
\quad 
\mathrm{Var}(\hat{\lambda}_{MLE}) = \frac{\lambda}{n}.
\\]

### 2. 불편 추정량 여부

MLE의 기댓값이 실제 \\(\lambda\\)와 같으므로, \\(\hat{\lambda}_{MLE}\\)는 **불편 추정량(unbiased estimator)** 입니다.

### 3. MLE의 분포와 점근분포

- 정확 분포(exact distribution):  
  \\(\hat{\lambda}_{MLE} = \bar{X} = \frac{1}{n}\sum_{i=1}^n X_i\\)이고, \\(\sum_{i=1}^n X_i\\)는 \\(\mathrm{Poisson}(n\lambda)\\)이므로  
  \\[
  \bar{X} = \frac{1}{n}\sum_{i=1}^n X_i 
  \\]
  는 \\(\frac{1}{n}\\)배한 이산적인 분포를 가집니다(정확히는 \\(\sum_{i=1}^n X_i\\)의 분포를 \\(\frac{1}{n}\\) 스케일링).

- 점근분포(asymptotic distribution):  
  큰 \\(n\\)에 대해서 중심극한정리에 의해 
  \\[
  \sum_{i=1}^n X_i \approx \mathcal{N}(n\lambda, n\lambda),
  \\]
  이므로 
  \\[
  \bar{X} = \frac{1}{n}\sum_{i=1}^n X_i 
  \approx \mathcal{N}\bigl(\lambda, \tfrac{\lambda}{n}\bigr).
  \\]
  즉, \\(\hat{\lambda}_{MLE}\\)는 \\(n\\)이 클 때 
  \\[
  \hat{\lambda}_{MLE} \xrightarrow{d} \mathcal{N}\bigl(\lambda, \tfrac{\lambda}{n}\bigr).
  \\]
  (정규분포로 근사될 수 있음을 의미합니다.)

---

# R 코드 예시

간단한 예시로, 실제 \\(\lambda = 3\\)인 포아송 분포에서 표본 크기 \\(n=100\\)을 뽑아 MLE를 계산해보겠습니다.

```{r poisson-mle-simulation, echo=TRUE}
set.seed(123)

# 1) 데이터 시뮬레이션
n <- 100
lambda_true <- 3
X <- rpois(n, lambda_true)

# 2) MLE 계산
lambda_hat <- mean(X)

# 3) 결과 확인
cat("True lambda =", lambda_true, "\n")
cat("MLE (sample mean) =", lambda_hat, "\n")
cat("Difference =", lambda_hat - lambda_true, "\n")
```

실행하면 \\(\hat{\lambda}_{MLE}\\)가 얼마나 실제 \\(\lambda\\)에 근접한지를 간단히 볼 수 있습니다.

---

## 결론 정리

1. **MLE**  
   \\( \hat{\lambda}_{MLE} = \bar{X} = \frac{1}{n}\sum_{i=1}^n X_i. \\)
2. **기댓값/분산**  
   \\( \mathrm{E}[\hat{\lambda}_{MLE}] = \lambda, \quad 
       \mathrm{Var}(\hat{\lambda}_{MLE}] = \frac{\lambda}{n}. \\)
3. **불편성**  
   \\( \hat{\lambda}_{MLE} \\)는 불편 추정량이다.
4. **(정확) 분포**  
   \\( \sum_{i=1}^n X_i \sim \mathrm{Poisson}(n\lambda) \\) 이므로 \\( \bar{X} = \frac{1}{n}\sum X_i \\)는 \\(\frac{1}{n}\\)-배 된 포아송 분포(이산) 형태.
5. **점근 분포**  
   \\( n \\)이 충분히 크면, 
   \\( \bar{X} \approx \mathcal{N}\bigl(\lambda, \tfrac{\lambda}{n}\bigr) \\) (중심극한정리).

---



**Type question 1 here**

Provide your answer here. For tips on Markdown syntax basics (e.g. bullet points, headers, bold, italics), here is an [easy guide](https://www.markdownguide.org/basic-syntax/). Note that you can embed equations like this: $X_{i} = 1$ and also like this:
$$
H(X) = - \sum_x P(X = x) \log P(X = x)
$$
If you want, you can also write up your solutions by hand and embed them as pictures to the PDF etc., but using latex equations is recommended. For a brief review on latex, here are some common things you might use in this course


$$
x_{ij}^n  
$$
$$
\sum_{x = 1}^{50} \log P(X = x) 
$$
 
$$
X \sim Binomial(n, p) 
$$
 
$$
\text{Embed text like this} 
$$

$$
\frac{1}{2} 
$$
$$ 
\alpha \neq 0.5 
$$
$$
I = \{ \pi, \beta, \sigma^2, \text{Banana, Apple, Penguin} \}
$$

## 2
**Type question 2 here** 

Include R code by putting them into code blocks

```{r cars}
summary(cars)
```

You can also embed plots, for example:

```{r pressure}
plot(pressure)
```


## Submit

Once you are done, click the **Knit** to include any final updates and in the HTML output page, there should be a button "Open in Browser". Once in browser, save the PDF (`Cmd + P` in mac or `Cntrl + P` in windows) and submit the PDF along with the R Markdown `.Rmd` file to canvas. Note that this is not the same as Knitting to PDF, which is fine but if your code is longer than 40 characters, will be cut off from the page. 




